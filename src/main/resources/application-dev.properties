# ===========================================
# DEVELOPMENT CONFIGURATION
# ===========================================

spring.application.name=DPMHC-backend
server.port=8081

# JPA/Hibernate Configuration for MySQL
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect

# ======================= PERFORMANCE OPTIMIZATION SETTINGS =======================

# Enable Hibernate query caching
spring.jpa.properties.hibernate.cache.use_second_level_cache=true
spring.jpa.properties.hibernate.cache.use_query_cache=true
spring.jpa.properties.hibernate.cache.region.factory_class=org.hibernate.cache.jcache.JCacheRegionFactory

# Hibernate query performance tuning
spring.jpa.properties.hibernate.jdbc.batch_size=25
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.batch_versioned_data=true

# MySQL deadlock and timeout settings
spring.jpa.properties.hibernate.connection.isolation=2

# Connection pool performance
spring.jpa.properties.hibernate.connection.provider_disables_autocommit=true

# Query performance optimization
spring.jpa.properties.hibernate.query.plan_cache_max_size=2048
spring.jpa.properties.hibernate.query.plan_parameter_metadata_max_size=128

# Enable statistics for monitoring (disable in production)
spring.jpa.properties.hibernate.generate_statistics=false

# Fetch size optimization
spring.jpa.properties.hibernate.jdbc.fetch_size=50

# Enable lazy loading optimization
spring.jpa.properties.hibernate.enable_lazy_load_no_trans=false

# Disable SQL init to prevent conflicts
spring.sql.init.mode=never

# Master-Slave Database Configuration (Environment Variables)
app.database.master.url=${DB_MASTER_URL}
app.database.master.username=${DB_MASTER_USERNAME}
app.database.master.password=${DB_MASTER_PASSWORD}
app.database.master.driver-class-name=com.mysql.cj.jdbc.Driver
app.database.master.max-pool-size=25
app.database.master.min-pool-size=5
app.database.master.connection-timeout-ms=30000
app.database.master.idle-timeout-ms=600000
app.database.master.max-lifetime-ms=1800000

# Slave Database 1 Configuration
app.database.slaves[0].name=Slave-1-Pool
app.database.slaves[0].url=${DB_SLAVE1_URL}
app.database.slaves[0].username=${DB_SLAVE1_USERNAME}
app.database.slaves[0].password=${DB_SLAVE1_PASSWORD}
app.database.slaves[0].driver-class-name=com.mysql.cj.jdbc.Driver
app.database.slaves[0].max-pool-size=20
app.database.slaves[0].min-pool-size=3
app.database.slaves[0].connection-timeout-ms=30000
app.database.slaves[0].idle-timeout-ms=600000
app.database.slaves[0].max-lifetime-ms=1800000
app.database.slaves[0].enabled=true

# Slave Database 2 Configuration
app.database.slaves[1].name=Slave-2-Pool
app.database.slaves[1].url=${DB_SLAVE2_URL}
app.database.slaves[1].username=${DB_SLAVE2_USERNAME}
app.database.slaves[1].password=${DB_SLAVE2_PASSWORD}
app.database.slaves[1].driver-class-name=com.mysql.cj.jdbc.Driver
app.database.slaves[1].max-pool-size=20
app.database.slaves[1].min-pool-size=3
app.database.slaves[1].connection-timeout-ms=30000
app.database.slaves[1].idle-timeout-ms=600000
app.database.slaves[1].max-lifetime-ms=1800000
app.database.slaves[1].enabled=true

# Connection Pool Configuration
app.database.connection-pool.auto-commit=false
app.database.connection-pool.leak-detection-threshold-ms=60000
app.database.connection-pool.connection-test-query=SELECT 1
app.database.connection-pool.cache-statements=true
app.database.connection-pool.prepared-statement-cache-size=250

# Health Check Configuration
app.database.health-check.enabled=true
app.database.health-check.interval-ms=30000
app.database.health-check.timeout-ms=5000
app.database.health-check.failure-threshold=3
app.database.health-check.recovery-threshold=2

# Load Balancing Configuration
app.database.load-balancing.default-strategy=ROUND_ROBIN
app.database.load-balancing.user-specific-routing=true
app.database.load-balancing.user-affinity-timeout-ms=300000
app.database.load-balancing.enable-metrics=true

# JWT Configuration (Environment Variables)
app.jwt.secret=${JWT_SECRET}
app.jwt.expiration=${JWT_EXPIRATION}
app.jwt.refresh-expiration=${JWT_REFRESH_EXPIRATION}

# File Upload Configuration
app.upload.max-file-size=52428800
app.upload.allowed-types=image/*,video/*,audio/*,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document

spring.servlet.multipart.max-file-size=50MB
spring.servlet.multipart.max-request-size=50MB
spring.servlet.multipart.enabled=true

# Cloudinary Configuration (Environment Variables)
cloudinary.cloud_name=${CLOUDINARY_CLOUD_NAME}
cloudinary.api_key=${CLOUDINARY_API_KEY}
cloudinary.api_secret=${CLOUDINARY_API_SECRET}

# WebSocket Configuration
spring.websocket.max-text-message-size=8192
spring.websocket.max-binary-message-size=8192

# Jackson Configuration
spring.jackson.deserialization.fail-on-unknown-properties=false
spring.jackson.deserialization.accept-empty-string-as-null-object=true

# Email Configuration (Environment Variables)
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=${MAIL_USERNAME}
spring.mail.password=${MAIL_PASSWORD}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.ssl.trust=smtp.gmail.com
spring.mail.properties.mail.smtp.from=${MAIL_USERNAME}

# Pagination Configuration
spring.data.web.pageable.default-page-size=10
spring.data.web.pageable.max-page-size=50
spring.data.web.pageable.page-parameter=page
spring.data.web.pageable.size-parameter=size

# Application URL (Environment Variables)
app.base.url=${APP_BASE_URL}
app.refresh-token.max-per-user=10
app.refresh-token.cleanup-delay=86400000

# ======================= REDIS CACHING CONFIGURATION =======================

# Redis connection settings (Environment Variables)
spring.data.redis.host=${REDIS_HOST}
spring.data.redis.port=${REDIS_PORT}
spring.data.redis.password=${REDIS_PASSWORD}
spring.data.redis.database=${REDIS_DATABASE}
spring.data.redis.timeout=5000ms

# Redis connection pool settings
spring.data.redis.lettuce.pool.max-active=20
spring.data.redis.lettuce.pool.max-idle=10
spring.data.redis.lettuce.pool.min-idle=5
spring.data.redis.lettuce.pool.max-wait=-1ms

# Cache settings
spring.cache.type=redis
spring.cache.redis.time-to-live=1800000
spring.cache.redis.cache-null-values=false
spring.cache.redis.key-prefix=socialmedia:
spring.cache.redis.use-key-prefix=true

# Redis performance tuning
spring.data.redis.lettuce.pool.time-between-eviction-runs=30000ms
spring.data.redis.lettuce.cluster.refresh.adaptive=true
spring.data.redis.lettuce.cluster.refresh.period=30000ms

# Enable Redis repositories (optional)
spring.data.redis.repositories.enabled=false